#!/bin/sh
set -e

RPROFILE="/etc/R/Rprofile.site"
PROFILED="/etc/R/profile.d"
MARKER="# Source /etc/R/profile.d/ drop-in scripts"

case "$1" in
    configure)
        # Add generic profile.d sourcing (idempotent)
        if ! grep -q "$MARKER" "$RPROFILE"; then
            cat >> "$RPROFILE" << 'EOF'

# Source /etc/R/profile.d/ drop-in scripts
for (f in list.files("/etc/R/profile.d", pattern = "\\.R$", full.names = TRUE))
    source(f)
EOF
        fi
        ;;
esac

#DEBHELPER#

exit 0
